<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½“è‚²è€å¸ˆå…¨èƒ½å·¥å…·ç®±</title>
    <!-- å¼•å…¥æ‰€éœ€åº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mammoth@1.4.8/mammoth.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 10px; background: #f5f5f5; }
        .tab { display: flex; gap: 5px; margin: 10px 0; }
        .tab button {
            flex: 1; padding: 12px; border: none; background: #2196F3; 
            color: white; border-radius: 8px; cursor: pointer;
        }
        .tabcontent { display: none; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .active { display: block !important; }
        input, textarea, select, button { 
            width: 100%; padding: 12px; margin: 8px 0; 
            border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box;
        }
        button.primary { background: #2196F3; }
        button.success { background: #4CAF50; }
        #result { margin-top: 15px; white-space: pre-wrap; padding: 12px; background: #e3f2fd; border-radius: 6px; }
    </style>
</head>
<body>

<h2 style="text-align: center; color: #2196F3;">ğŸ€ ä½“è‚²è€å¸ˆå·¥å…·ç®±</h2>

<div class="tab">
    <button onclick="showTab('lesson')">æ•™æ¡ˆç”Ÿæˆ</button>
    <button onclick="showTab('file')">æ–‡ä»¶è½¬æ¢</button>
    <button onclick="showTab('text')">æ–‡å­—è½¬æ¢</button>
</div>

<!-- æ•™æ¡ˆç”Ÿæˆ -->
<div id="lesson" class="tabcontent active">
    <input type="text" id="topic" placeholder="æ•™å­¦ä¸»é¢˜ï¼ˆå¦‚ï¼šç¯®çƒä¸‰æ­¥ä¸Šç¯®ï¼‰">
    <input type="text" id="grade" placeholder="é€‚ç”¨å¹´çº§ï¼ˆå¦‚ï¼šå…«å¹´çº§ï¼‰">
    <input type="number" id="duration" placeholder="è¯¾æ—¶æ•°ï¼ˆå¦‚ï¼š2ï¼‰">
    <button class="primary" onclick="generateLesson()">ç”Ÿæˆæ•™æ¡ˆ</button>
    <div id="lessonResult"></div>
</div>

<!-- æ–‡ä»¶è½¬æ¢ -->
<div id="file" class="tabcontent">
    <input type="file" id="fileInput" accept=".docx,.pdf,.md">
    <select id="fileFormat">
        <option value="docx">è½¬æˆWord</option>
        <option value="pdf">è½¬æˆPDF</option>
        <option value="md">è½¬æˆMarkdown</option>
    </select>
    <button class="primary" onclick="convertFile()">å¼€å§‹è½¬æ¢</button>
    <div id="fileResult"></div>
</div>

<!-- æ–‡å­—è½¬æ¢ -->
<div id="text" class="tabcontent">
    <textarea id="textInput" rows="6" placeholder="è¾“å…¥è¦è½¬æ¢çš„æ–‡å­—..."></textarea>
    <select id="textFormat">
        <option value="docx">è½¬æˆWord</option>
        <option value="pdf">è½¬æˆPDF</option>
        <option value="md">è½¬æˆMarkdown</option>
    </select>
    <button class="primary" onclick="convertText()">å¼€å§‹è½¬æ¢</button>
    <div id="textResult"></div>
</div>

<script>
// å…¨å±€å·¥å…·å¯¹è±¡
const Tools = {
    // æ˜¾ç¤ºæ ‡ç­¾é¡µ
    showTab: (tabName) => {
        document.querySelectorAll('.tabcontent').forEach(tab => tab.style.display = 'none');
        document.getElementById(tabName).style.display = 'block';
    },

    // ç”Ÿæˆæ•™æ¡ˆï¼ˆç¤ºä¾‹æ•°æ®ï¼Œå®é™…éœ€æ¥å…¥AIï¼‰
    generateLesson: () => {
        const topic = document.getElementById('topic').value;
        const grade = document.getElementById('grade').value;
        const duration = document.getElementById('duration').value;
        
        const lessonContent = `
            ã€æ•™å­¦ä¸»é¢˜ã€‘${topic}
            ã€é€‚ç”¨å¹´çº§ã€‘${grade}
            ã€è¯¾æ—¶å®‰æ’ã€‘${duration}è¯¾æ—¶
            ã€æ•™å­¦ç›®æ ‡ã€‘
            1. æŒæ¡åŸºç¡€åŠ¨ä½œè¦é¢†
            2. åŸ¹å…»å›¢é˜Ÿåä½œèƒ½åŠ›
            3. æé«˜èº«ä½“åè°ƒæ€§
            
            ã€æ•™å­¦æµç¨‹ã€‘
            1. çƒ­èº«è¿åŠ¨ï¼ˆ10åˆ†é’Ÿï¼‰
            2. åŠ¨ä½œç¤ºèŒƒè®²è§£ï¼ˆ15åˆ†é’Ÿï¼‰
            3. åˆ†ç»„ç»ƒä¹ ï¼ˆ20åˆ†é’Ÿï¼‰
            4. æ€»ç»“ç‚¹è¯„ï¼ˆ5åˆ†é’Ÿï¼‰
        `;

        const resultDiv = document.getElementById('lessonResult');
        resultDiv.innerHTML = `<pre>${lessonContent}</pre>
            <button class="success" onclick="Tools.downloadFile('æ•™æ¡ˆå†…å®¹.docx', '${lessonContent}')">ä¸‹è½½Wordç‰ˆ</button>
            <button class="success" onclick="Tools.exportToPDF('æ•™æ¡ˆå†…å®¹.pdf', '${lessonContent}')">ä¸‹è½½PDFç‰ˆ</button>`;
    },

    // æ–‡ä»¶è½¬æ¢æ ¸å¿ƒæ–¹æ³•
    convertFile: () => {
        const file = document.getElementById('fileInput').files[0];
        const format = document.getElementById('fileFormat').value;
        
        if (!file) {
            alert('è¯·å…ˆé€‰æ‹©æ–‡ä»¶ï¼');
            return;
        }

        const reader = new FileReader();
        reader.onload = async (e) => {
            let content;
            // DOCXè½¬å…¶ä»–æ ¼å¼
            if (file.name.endsWith('.docx')) {
                const result = await mammoth.convertToHtml({ arrayBuffer: e.target.result });
                content = result.value;
            } 
            // PDF/MDå¤„ç†ï¼ˆç®€åŒ–ç¤ºä¾‹ï¼‰
            else {
                content = await e.target.result;
            }

            let output;
            switch(format) {
                case 'docx':
                    output = `<h3>${file.name}.docx</h3>`;
                    Tools.downloadFile('converted.docx', content);
                    break;
                case 'pdf':
                    const doc = new jspdf.jsPDF();
                    doc.text(content, 10, 10);
                    doc.save('converted.pdf');
                    break;
                case 'md':
                    Tools.downloadFile('converted.md', content);
                    break;
            }
            document.getElementById('fileResult').innerHTML = output || 'è½¬æ¢å®Œæˆï¼';
        };

        if (file.name.endsWith('.docx')) {
            reader.readAsArrayBuffer(file);
        } else {
            reader.readAsText(file);
        }
    },

    // æ–‡å­—è½¬æ¢å¤„ç†
    convertText: () => {
        const text = document.getElementById('textInput').value;
        const format = document.getElementById('textFormat').value;
        let output;

        switch(format) {
            case 'docx':
                Tools.downloadFile('content.docx', text);
                break;
            case 'pdf':
                const doc = new jspdf.jsPDF();
                doc.text(text, 10, 10);
                doc.save('content.pdf');
                break;
            case 'md':
                Tools.downloadFile('content.md', text.replace(/\n/g, '\n\n'));
                break;
        }
        document.getElementById('textResult').innerHTML = 'è½¬æ¢å®Œæˆï¼';
    },

    // é€šç”¨ä¸‹è½½æ–¹æ³•
    downloadFile: (filename, content) => {
        const blob = new Blob([content], { type: 'application/octet-stream' });
        saveAs(blob, filename);
    },

    // å¯¼å‡ºPDF
    exportToPDF: (filename, content) => {
        const doc = new jspdf.jsPDF();
        doc.text(content, 10, 10);
        doc.save(filename);
    }
}

// åˆå§‹åŒ–æ ‡ç­¾é¡µ
document.querySelector('.tab button').click();

// ç»‘å®šæŒ‰é’®äº‹ä»¶
document.getElementById('lesson').querySelector('button').onclick = Tools.generateLesson;
document.getElementById('file').querySelector('button').onclick = Tools.convertFile;
document.getElementById('text').querySelector('button').onclick = Tools.convertText;
</script>
</body>
</html>